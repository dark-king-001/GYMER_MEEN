<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>homepage</title>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.css"/>
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick-theme.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
      <link rel="stylesheet" href="/css/Home.css">
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@200;400;500&display=swap">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
      <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
      <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
      <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

  </head>
   </head>
   <style>
      .slider{
        width:100%;
        /* height: 30vw; */
        padding: 0;
        margin:0 auto;
        padding: 0;
        margin-top: 2vw;
        background-color: #000;
    }

    .review{
        width:100%;
        padding: 2rem;
        margin: 0 auto;
        background-color: #000;
    }

    .review-fit{
       width: 80%;
       display: flex !important;
       flex-direction: column;
       justify-content: center;
       align-items: center;
       background-color: #fff;
       backdrop-filter: blur(10px);
       box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
       padding: 1rem;
       border-radius: 1rem;
       box-shadow: 0px 0px 5px 0px #fff;
    }

    .slider .slick-arrow{
        display: block;
        color: #fff;
    }

    .slick-prev:before,
.slick-next:before {
    font-size: 3vw;
}

    .slider .slick-next{
        position: absolute;
        top: 10vw;
        right: 5vw;
    }
    .slider .slick-prev{
        position: absolute;
        top: 10vw;
        left: 4vw;
        /* left: 0vw; */
    }


    .review .slick-slide{
       margin-left: 1rem !important;
       margin-right: 1rem !important;
    }

    .review-fit img{
       width: 150px;
       border-radius: 35%;
       height: auto;
    }

    .alert {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 1;
    padding: 0.75rem 1.25rem;
    margin-bottom: 1rem;
    border: 1px solid transparent;
    border-radius: 0.25rem;
    transition: 0.3s ease-in-out;
  }

  .alert.success {
    color: #155724;
    background-color: #d4edda;
    border-color: #c3e6cb;
  }

  .close {
    cursor: pointer;
  }

    .review-fit h5{
      font-style:italic;
    }

    .review-fit i{
       margin-bottom: 1rem;
       color: goldenrod;
       margin-top: 1rem;
    }

    .review-fit .insta-id i{
       color: #000;
       margin-right: 0.4rem;
    }


    /* .slider img{
        width: 100%;
        height:auto;
    } */
    .slider .slick-slide{
        height:auto!important;
    }

    .slider .slick-slide{
    margin-right: 2rem !important;
    margin-left: 2rem!important;
   }

   @media (max-width: 576px){
      .slider{
         padding: 0;
         height: max-content;
      }

   }
   
   </style>
   <body>
      <%- include('partials/nav') %> 
      <%- include('partials/cart') %>


      <div id="alertContainer"></div>

         <div class="slider">   
            <div><img src="../assets/Slider.jpg"></div>
            <div><img src="../assets/Slider2.jpg"></div>
            <div><img src="../assets/Slider.jpg"></div>   
            <div><img src="../assets/Slider2.jpg"></div>
        </div>

        <div class="container" style="margin-left:6vw;width: 50%;">
         <button class="btn btn-light align-left mb-5 mt-5"><a href="/product_listing/explore" style="text-decoration: none;color: #000;font-weight: 500;font-size: 1.2rem">Explore Now</a></button>
      </div>
      <div class="container products-bar mt-4">
         <div class="mb-2 filters d-flex justify-content-around align-items-center text-uppercase">
            <!-- <button class="category-btn m-1" onclick="renderProducts('all')">All</button> -->
            <button class="category-btn m-1" onclick="renderProducts('Face Care')">Face Care</button>
            <button class="category-btn m-1" onclick="renderProducts('Hair Care')">Hair Care</button>
            <button class="category-btn m-1" onclick="renderProducts('Body Care')">Body Care</button>
            <!-- <button class="category-btn m-1" onclick="renderProducts('Beard Care')">Beard Care</button> -->
         </div>   
         <div id="productGrid" class="row product-grid" onmousedown="startScroll(event)" onmouseup="stopScroll()" ontouchstart="startScroll(event)" ontouchend="stopScroll()">
         </div>

         <div class="d-flex justify-content-center p-4 mt-5 mb-5" >
            <button class="show-btn"><a href="/product_listing">Show More</a></button>
         </div>
      </div>
      <div class="container-fluid mt-2 mb-2 p-0 banner-section">
         <img class="banner-image" src="assets/black-friday.jpg" alt="Banner Image">
      </div>
      <div class="container mt-5 mb-5">
         <h2 class="text-center text-white mb-4">Search Through Category</h2>
         <div class="row align-items-stretch">
             <div class="col-md-4 col-4 mt-2">
                 <div class="card bg-white text-center p-0 d-flex flex-column" style="border-radius: 1rem;">
                     <img src="assets/category1.jpg" class="card-img-top flex-grow-1" alt="Image 1" style="border-radius: 1rem 1rem 0 0">
                     <div class="card-body">
                         <h3 class="card-text font-weight-bold">Face Care</h3>
                     </div>
                 </div>
             </div>
             <div class="col-md-4 col-4 mt-2">
                 <div class="card bg-white text-center p-0 border-0 d-flex flex-column" style="border-radius: 1rem;">
                     <img src="assets/category3.jpg" class="card-img-top flex-grow-1" alt="Image 2" style="border-radius: 1rem 1rem 0 0">
                     <div class="card-body">
                         <h3 class="card-text font-weight-bold">Hair Care</h3>
                     </div>
                 </div>
             </div>
             <div class="col-md-4 col-4 mt-2">
                 <div class="card bg-white text-center p-0 border-0 d-flex flex-column" style="border-radius: 1rem;" style="border-radius: 1rem 1rem 0 0">
                     <img src="assets/category2.jpg" class="card-img-top flex-grow-1" alt="Image 3" style="border-radius: 1rem 1rem 0 0">
                     <div class="card-body">
                         <h3 class="card-text font-weight-bold">Body Care</h3>
                     </div>
                 </div>
             </div>
         </div>
     </div>


     <h2 class="text-center text-white mt-5 mb-0">See What Our Customers Say</h2>
     <style>
         .swiper-container {
            background-color: black;
            width: 95%;
            overflow: hidden;
            padding-bottom: 60px
         }
         .swiper-slide {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            width: 400px;
            height: auto;
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
         }
         
         .swiper-slide .ratings{
            margin-top: 2vh;
         }
         
         .swiper-slide .ratings .rating-number{
            font-size: 4vh;
            font-weight: bolder;
         }
         
         .swiper-slide .user-info .text-muted{
            margin-top: 2vh;
         }
         
         .swiper-slide .ratings iconify-icon{
            font-size: 4vh;
         }
         .swiper-slide img {
            width: 30vh;
            height: 30vh;
            border-radius: 50%;
            height: auto;
            margin-bottom: 5vh;
            display:block;
            margin:2vh auto;
         }
         
         .swiper-container-horizontal > .swiper-pagination-bullets{
            bottom: 0;
         }
         
         .swiper-pagination-bullet {
            margin: 0 8px!important;
         }
         .swiper-pagination-bullet {
            background: #fff;
            border: 1px solid #fff;
            border-radius: 100%;
            display: inline-block;
            height: 5px;
            opacity: 1;
            filter:  "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            width: 5px;
         }
         .swiper-pagination-bullet-active {
            background-color: grey;
            border: medium none;
            height: 7px;
            opacity: 1;
            filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            width: 7px;
         }
         
         @media screen and (max-width: 767px){
            .swiper-slide{
               width: 300px;
            }
         }
         
         .swiper-button-next,
               .swiper-button-prev {
                     color: #fff;
                     font-size: 18px;
                     margin: 0 10px;
               }
         
               .swiper-button-next:hover,
               .swiper-button-prev:hover {
                     color: #ee0f6f;
               }
         
      </style>
     <div class="container py-5">
		<div class="row">
			<div class="col-12">
				<div class="swiper-container mySwiper">
					<div class="swiper-wrapper">
					<div class="swiper-slide">
                        <img src="../assets/spray1.jpg" alt="" class="img-fluid" />
                        
                        <div class="user-info">
                            <small class="text-muted">@username</small>
                            <div class="ratings d-flex justify-content-center align-items-center">
                                <span class="rating-number">4.0</span>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <img src="../assets/spray1.jpg" alt="" class="img-fluid" />
                        
                        <div class="user-info">
                            <small class="text-muted">@username</small>
                            <div class="ratings d-flex justify-content-center align-items-center">
                                <span class="rating-number">4.0</span>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <img src="../assets/spray1.jpg" alt="" class="img-fluid" />
                        
                        <div class="user-info">
                            <small class="text-muted">@username</small>
                            <div class="ratings d-flex justify-content-center align-items-center">
                                <span class="rating-number">4.0</span>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <img src="../assets/spray1.jpg" alt="" class="img-fluid" />
                        
                        <div class="user-info">
                            <small class="text-muted">@username</small>
                            <div class="ratings d-flex justify-content-center align-items-center">
                                <span class="rating-number">4.0</span>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <img src="../assets/spray1.jpg" alt="" class="img-fluid" />
                        
                        <div class="user-info">
                            <small class="text-muted">@username</small>
                            <div class="ratings d-flex justify-content-center align-items-center">
                                <span class="rating-number">4.0</span>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                                <iconify-icon icon="emojione:star"></iconify-icon>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        </div>
                    </div>
						
					</div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
					<div class="swiper-pagination"></div>
				</div>
			</div>
		</div>
	</div>
   <script>
      var swiper = new Swiper('.mySwiper', {
          pagination: {
              el: '.swiper-pagination',
              clickable: true,
          },
          navigation: {
              nextEl: '.swiper-button-next',
              prevEl: '.swiper-button-prev',
          },
          effect: 'coverflow',
          loop: true,
          centeredSlides: true,
          slidesPerView: 'auto',
          coverflowEffect: {
              rotate: 30, 
              stretch: 80,
              depth: 300,
              modifier: 1,
              slideShadows: false,
          }
      });
  </script>

      
<%- include('partials/footer') %>

      <script>
         let products = [];

         document.addEventListener('DOMContentLoaded', async () => {
            try {
               const response = await fetchProducts('/api/products');
               products = response;
               renderProducts('all');
            } catch (error) {
               showAlert("error while fetching the products","danger")
            }
         });

         async function fetchProducts(apiEndpoint) {
            const response = await axios.get(apiEndpoint);
            return response.data;
         }

         function attachAddToCartListeners(products) {
            products.forEach(product => {
                  const addButton = document.querySelector(`.add${product.itemId}`);
                  addButton.addEventListener('click', async (event) => {
                     event.preventDefault();
                     try {
                        const response = await addToCart('/addItem', { itemId: product.itemId });
                        if (response.status === 200) {
                              console.log(response.data.message);
                              showAlert('item added to cart','success')
                              openCart()
                              // Optionally, update the UI to reflect the item being added to the cart
                        } else {
                              console.error('Error adding item to cart:', response.data.message);
                              // Optionally, handle the error and update the UI accordingly
                        }
                     } catch (err) {
                        if (err.response.status === 400){
                           showAlert("Item already in cart","success")
                           openCart()
                        } else {
                           window.location.href = "/login"
                        }
                     }
                  });
            });
         }
         async function addToCart(apiEndpoint, data) {
            return await axios.post(apiEndpoint, data);
         }

         function renderProducts(categoryFilter) {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '';

            const filteredProducts = categoryFilter === 'all' ? products : products.filter(product => product.category === categoryFilter);

            filteredProducts.forEach(product => {
                  const productCard = createProductCard(product);
                  productGrid.appendChild(productCard);
            });

            attachAddToCartListeners(filteredProducts);
         }
         function createProductCard(product) {
         const productCard = document.createElement('div');
         productCard.className = 'col-md-4 product-card product';
         productCard.innerHTML = `
         <a href="/search/${product.itemId}" >
            <div class="product-image-container">
                  <img class="product-image" src="${product.imageLink[0]}" alt="${product.name}">
                  <img class="product-image hover-image" src="${product.imageLink[1] || product.imageLink[0]}" alt="${product.name}" style="display:none">
            </div>
            <div class="product-details">
                  <div class="category-badge text-white corner-round p-1" style="display:none;">${product.category}</div>
                  <div class="product-title"><a href="Product_Description.html" style="text-decoration:none;color:#000">${product.name}</a></div>
                  <div class="product-description">${product.description}</div>
                  <div class="mb-2">
                     <div class="d-flex justify-content-between bolder product-price-discount">
                        <div class="product-price">&#8377; ${product.offeredPrice}</div>
                        <div class="original-price text-secondary text-decoration-line-through">&#8377;${product.originalPrice || ''}</div>
                        <div class="product-discount text-success">${((product.originalPrice - product.offeredPrice) / product.originalPrice * 100).toFixed(0)}% Off</div>
                     </div>
                  </div>
                  <button onclick="showNotification()" class="add-to-cart-btn add${product.itemId}" id="liveToastBtn"><i class="fas fa-cart"></i> Add to Cart</button>
            </div>
         </a>
         `;

         const productImageContainer = productCard.querySelector('.product-image-container');
         const mainImage = productImageContainer.querySelector('.product-image');
         const hoverImage = productImageContainer.querySelector('.hover-image');

         productImageContainer.addEventListener('mouseenter', function () {
            mainImage.style.display = 'none';
            hoverImage.style.display = 'block';
         });

         productImageContainer.addEventListener('mouseleave', function () {
            mainImage.style.display = 'block';
            hoverImage.style.display = 'none';
         });

         

         return productCard;
      }

      // Example usage
      const container = document.getElementById('productContainer'); // Replace with the actual container element ID
      products.forEach(product => {
         const productCard = createProductCard(product);
         container.appendChild(productCard);
      });
      </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
      <script>
         
         $(document).ready(function(){
             setInterval(function(){
                 $('#customSlider .carousel-inner').animate({marginLeft: '-=100%'}, 1000, function(){
         
                     $(this).find('.carousel-item:first').appendTo(this);
                     $(this).css({marginLeft: 0});
                 });
             }, 1000); 
         });
      </script>
<script>
   $('.slider').slick({
   autoplay: true,
   dots: false,
   infinite: true,
   pauseOnHover: true,
   centerMode:true,        //added
   centerPadding:"5%", 
   arrows: false,   //added
})
</script>

<script>
   $('.review').slick({
  centerMode: true,
  centerPadding: '20vw',
  slidesToShow: 1,
  autoplay:true,
  arrows:false,
  responsive: [
    {
      breakpoint: 768,
      settings: {
        arrows: false,
        centerMode: true,
        centerPadding: '40px',
        slidesToShow: 3
      }
    },
    {
      breakpoint: 480,
      settings: {
        arrows: false,
        centerMode: true,
        centerPadding: '40px',
        slidesToShow: 1
      }
    }
  ]
});
</script>

<script>
   let isScrolling = false;

   function startScroll(event) {
       isScrolling = true;
       const scrollContainer = document.getElementById('productGrid');
       const startX = event.pageX || event.touches[0].pageX;
       let scrollLeft = scrollContainer.scrollLeft;

       function handleMouseMove(e) {
           const x = e.pageX || e.touches[0].pageX;
           const delta = x - startX;
           scrollContainer.scrollLeft = scrollLeft - delta;
       }

       function handleMouseUp() {
           isScrolling = false;
           document.removeEventListener('mousemove', handleMouseMove);
           document.removeEventListener('mouseup', handleMouseUp);
           document.removeEventListener('touchmove', handleMouseMove);
           document.removeEventListener('touchend', handleMouseUp);
       }

       document.addEventListener('mousemove', handleMouseMove);
       document.addEventListener('mouseup', handleMouseUp);
       document.addEventListener('touchmove', handleMouseMove);
       document.addEventListener('touchend', handleMouseUp);
   }

   function stopScroll() {
       isScrolling = false;
   }

   // Optional: Auto-hide scrollbar after a few seconds of inactivity
   let timeoutId;

   function hideScrollbar() {
       if (!isScrolling) {
           document.getElementById('productGrid').style.overflow = 'hidden';
       }
   }

   function showScrollbar() {
       document.getElementById('productGrid').style.overflow = 'auto';
   }

   document.getElementById('productGrid').addEventListener('scroll', function() {
       showScrollbar();
       clearTimeout(timeoutId);
       timeoutId = setTimeout(hideScrollbar, 2000); // Adjust the time as needed
   });

</script>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
   </body>
</html>